{"componentChunkName":"component---src-templates-post-js","path":"/post/2020/dynamic-connector-config/","result":{"data":{"mdx":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Dynamic Connector Configuration\",\n  \"shortDescription\": \"Frequently when building integrations, especially batch jobs, we don't necessarily know the configuration for all of the systems we will be connecting to ahead of time; the configurations are typically (and should be) externalized. While it doesn't feel intuitive, we can create a global configuration and use scoped variables to dynamically create new connector configurations at runtime.\",\n  \"date\": \"2020-12-29T00:00:00.000Z\",\n  \"published\": true,\n  \"tags\": [\"mft\", \"connectors\", \"sftp\", \"mulesoft\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"An extremely common pattern today involves managed file transfers. The scenario might involve a large number of SFTP servers that files must be downloaded / uploaded to either on a schedule, or near-real-time as the files are created.\"), mdx(\"p\", null, \"Let's consider a managed file transfer architecture like this:\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/2f25e80a62001c11704e06302e3fc9d1/mft-diagram.svg\",\n    \"alt\": \"mft-diagram.svg\"\n  }))), mdx(\"p\", null, \"With this approach, we now have a configurable file transfer agent (the MFT Task Processor) which utilizes an API for configuration; this flexible approach allows us to quickly build a process layer that we can control without touching code.\"), mdx(\"p\", null, \"The issue? In Mulesoft, when building applications, we typically have a single, static (possibly parametrized) connector configuration. A basic flow to download files from an SFTP server, and then upload any pending files to the same server, might look like this:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1000px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"72.8%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACAUlEQVQ4y5VTTW/UMBDNH+WCxIEzXOA3cOHChR+B1AMHVOAAWraV6KpqL4iKpckm2XxtnNj5cGL7MfZuYZW2LFh58kzsefM8HnthXmKVFvAJV3GOtehRDQaCwAdNIHs0qKV2s/WtzQcFOWrAGPr+wFtc1vj0ZYO8KjE73+DzQqIzGnGqcbLQ6Cmo5BrzrxpMbP2TM1rPiAwG0+G9eAk8fQ7UTYdXrxWePFMQfYc3RxIPHmnkucT8tCNb4WwxYJ10ePhY4eitonAN5UTuKTy/qDCbF7RkcPmtx+y0dXnDcMC795XLyrnB8UcBIWwQcPyBIYwHp9D6lui3QsYy5FmImguMUBggMdi0sAoktNZOCTC4eetLwrizJ4SKgqUkKqW22VxpDLTF3nGmtt7Ztwj3C2omN2b2gqb77rJvEd437kt0F7yqYlRsAS0lHZ3qRxjH0dkWSo34n+GtkgJFsQErGcqyRrFhYFVFc4kNoaT/XDQQTUtoDoIUNsiSBH4QYhn8xPcfAYJghavlklonxmoVIc1ylyAvDsNr9U2/G2TVEmmaUDMTQVG4o9u62A74V3jrNEff97sGbhHHa0dYc+7+39TSwvqH4PnX14iiiJ4QPX7BiTBCQiWwF9V1ndvUtq2brQKr+m/wsixzgfZonFQFQUC1C+H7vkvEGHMJ7D5LfAi/AAm3g6KtHUd+AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"sftp-with-scheduler.png\",\n    \"title\": \"sftp-with-scheduler.png\",\n    \"src\": \"/static/fe18105eca05d3b7268ad0f0c50d6428/00d43/sftp-with-scheduler.png\",\n    \"srcSet\": [\"/static/fe18105eca05d3b7268ad0f0c50d6428/63868/sftp-with-scheduler.png 250w\", \"/static/fe18105eca05d3b7268ad0f0c50d6428/0b533/sftp-with-scheduler.png 500w\", \"/static/fe18105eca05d3b7268ad0f0c50d6428/00d43/sftp-with-scheduler.png 1000w\", \"/static/fe18105eca05d3b7268ad0f0c50d6428/e5ca1/sftp-with-scheduler.png 1332w\"],\n    \"sizes\": \"(max-width: 1000px) 100vw, 1000px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"So how do we go about iterating through our configuration and connecting to each SFTP server when the connector configuration needs to be a global element? Exactly the same way we pass any kind of parameters to Mulesoft! In the background, the connector has a configuration manager which will check if the connection already exists, and if it doesn't, will create it. This allows us to setup our flow like so:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1000px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"65.60000000000001%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACbklEQVQ4y21Sy2oUQRTt33SnC0FQEVQCWQSCAVERiaiLLHThSoUoWbgS4tuZUdcazWBCnJ7p7unnTFd1d72Ot6o6WQSrKerevnUfdc4JsrzALIqRZjmyokRRJpCKw66KCUyyBaKyQN4opExjITW40ci5Rke2oc8vQ3kagZICUrSwJ4x0NrRyV3grMM0K/AljMEpeCuPORafdabQv5q9TaWoUGGMN30NKg60nGg+2FBhNQH8w/KqwcbvD/tj6CjuvJe7el0hTH/+xp3BnU+DTwFalgkIItG0LrSWWtcbahsTqukKc0KRgeLatcOacxtsPkhrXuPdQ4eI1jb3f2sV337dYWQO2d/qCOLWO/nIcHLITv6o6DEYJhNR9fInRt8Ql24cpwm0wmqGsGvfsoF4usKhKJHEEa8Nf8zBrixNNpjlNp3q/874FzmJFuMFQsT4ehOkSR0mJwyh3Z5hxREWLjEkUXKFqDEq6X5JdEtMFYVsQ29bPaWeMNkE1ryW4UAjmxOI0niOeZ4hoJ2mMqq5AL6EkibDgSGqOORVJKDFvqZjQzm8IBtkzLU0vm9MYkiQRTr2t6VnTqMLnYYJW+MS0MBgfaCgnDa+Qn79IRsz8n+WrqwJXViTi2LP8csfg7AWDdx8l+bWTzPlLqpcRw5vdBpevazzf7lm2OtTad1PK4PHTjrTYUROvsy9DifWbrJeJxotXLW7cYpinxsX3xxKbjxhG34VnWSlixxhHv11CNFSM9U8mjGRL0yYnzDO2QJLEzveDKMxmkbtn6wTWmUxC6jRGGIZomgacN5TI+s0dJHXN3LaxY/843nWdOxnn+AdTKte8In486gAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"mft-sftp-flows.png\",\n    \"title\": \"mft-sftp-flows.png\",\n    \"src\": \"/static/6ac4a78366457a6370169258b760f58d/00d43/mft-sftp-flows.png\",\n    \"srcSet\": [\"/static/6ac4a78366457a6370169258b760f58d/63868/mft-sftp-flows.png 250w\", \"/static/6ac4a78366457a6370169258b760f58d/0b533/mft-sftp-flows.png 500w\", \"/static/6ac4a78366457a6370169258b760f58d/00d43/mft-sftp-flows.png 1000w\", \"/static/6ac4a78366457a6370169258b760f58d/48ca3/mft-sftp-flows.png 1084w\"],\n    \"sizes\": \"(max-width: 1000px) 100vw, 1000px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"And use a connector configuration setup with the current scope's variables rather than static parameters:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1000px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"101.6%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAADYklEQVQ4y51US2/bRhDmn8q5PyKn/IkSuQRFhJ7t6JAEBdJDJAc10Ev/QWM7Cmw4dmXIlikd6rdEUhLfb1J8rLiTmbXk2ElboBHwaZa7s9/OfDO70tn7ncenex+f/ql05EFfkXvHPbnX68nHx8fywcGBvLW1Je/s7MidTkfe3t4Wc7RGPvfw42n/5Nmn/b1H0kX/tH82VOBo2ANjZkAYhgJRFIHv+2AYhoBlWTCbzcB1XbG28rv1DcH1Ijg4GjYlLwwO0yyDKAgrJFgURbEAgP8FDlB6CcD73eELaaRPu7Yfgum49WxmcMO0+GQ6E9b1fO643gO4Av4DWLbLTDuAvf1uUxqNRl3bdsC0rPri8pJrmg6maYHn+ZAkKcRxAjHZ/0KcsPl8DqhtU9I0rUv6+L5X53nOiyKH7/gx+hsMBk3JdpxuhKdYflSbls1N0wYPJfD8AIUOMNIl/H+H4/osSbMloW130zTFTV6t6TqfTCYQBFS5GDJMgwqW4Dql/4/AtXmWsDwvQFGQ0MEIy7IE13FqVVUFIYFaJMKWiOMYUAogn7Islra8+y6KEjR7zsqqguFgSUjs2F81EvHpdIpFMUXvBUEgQBkQKQl/HzSXZXMkzFhZVrcpEyH2HmDqNRaI67pOY9HAFMWKKMPUvwbNp6idaqWs+JoQO75GHTndgpVzVTFEBYyxb0DzdCClPHFLRr6DgdKUMBKhIRLXCE7OSZII5FkkrlWwvGIrCQi0TqSERZUz2qcoCkXo3qWMmziNb25uQNNUCF0dVHUsvvECwPX1NVxdXQlLOt+mnFJXMArqQcoUIRaCkxNWG6ZY6dibgq5pMB6PBVakNNbQByUC2osyfUuIZPX5+TmnE+l0ah3bMkT70JiqT5ZuVZYmMLVCuFJNsEyD/BmlLghXGqJjjadz7DtOWuLLQ9FyLNCdxcM4Xc+qLNGWPM3m6B/RHrZg7JbQMMxDEZVlMUxpQf2I3zUSCPsF2d0c3hBETK9TPVa1Gl+nMpvncHLSfyH9fXbRH6k6aYiauKL/aEyW+pHSpN6kOWopsjPDhAI74MMghLedFH7bTeCPwwQO/+q+lFrt9pPNzc2fWq1Wg9Butx9gY2Oj8Q5B49U6zW20W41ffm031l+3G2uvWs/ftH7/eW19/YfP6AqolkxeuawAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"scoped-sftp-config\",\n    \"title\": \"scoped-sftp-config\",\n    \"src\": \"/static/91d44dd962f98a6e311736ac8ff24e23/00d43/scoped-sftp-config.png\",\n    \"srcSet\": [\"/static/91d44dd962f98a6e311736ac8ff24e23/63868/scoped-sftp-config.png 250w\", \"/static/91d44dd962f98a6e311736ac8ff24e23/0b533/scoped-sftp-config.png 500w\", \"/static/91d44dd962f98a6e311736ac8ff24e23/00d43/scoped-sftp-config.png 1000w\", \"/static/91d44dd962f98a6e311736ac8ff24e23/9685e/scoped-sftp-config.png 1336w\"],\n    \"sizes\": \"(max-width: 1000px) 100vw, 1000px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"Now each time we iterate through our configuration and call an SFTP operation, the connection will be created if it doesn't already exist! This trick isn't limited to the SFTP connector either; this will work for the vast majority of connectors. \"), mdx(\"h3\", {\n    \"id\": \"this-method-wont-work-with-event-sources-ie-connectors-that-go-in-the-source-section-of-a-flow-for-that-you-would-need-to-use-flow-templates-and-some-code-to-dynamically-create-new-flows\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#this-method-wont-work-with-event-sources-ie-connectors-that-go-in-the-source-section-of-a-flow-for-that-you-would-need-to-use-flow-templates-and-some-code-to-dynamically-create-new-flows\",\n    \"aria-label\": \"this method wont work with event sources ie connectors that go in the source section of a flow for that you would need to use flow templates and some code to dynamically create new flows permalink\",\n    \"className\": \"autolink-header before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"This method won't work with event sources (ie: connectors that go in the Source section of a flow); for that you would need to use flow templates and some code to dynamically create new flows.\"), mdx(\"p\", null, \"For a reference solution \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"(note: NOT for production use as-is)\"), \", take a look at these repositories:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/mikeacjones/mft_config-sapi\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://github.com/mikeacjones/mft_config-sapi\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/mikeacjones/mft_job-papi\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://github.com/mikeacjones/mft_job-papi\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/mikeacjones/mft_task-processor\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"https://github.com/mikeacjones/mft_task-processor\"))), mdx(\"style\", {\n    \"className\": \"grvsc-styles\"\n  }, \"\\n  .grvsc-container {\\n    overflow: auto;\\n    position: relative;\\n    -webkit-overflow-scrolling: touch;\\n    padding-top: 1rem;\\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\\n    padding-bottom: 1rem;\\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\\n    border-radius: 8px;\\n    border-radius: var(--grvsc-border-radius, 8px);\\n    font-feature-settings: normal;\\n    line-height: 1.4;\\n  }\\n  \\n  .grvsc-code {\\n    display: table;\\n  }\\n  \\n  .grvsc-line {\\n    display: table-row;\\n    box-sizing: border-box;\\n    width: 100%;\\n    position: relative;\\n  }\\n  \\n  .grvsc-line > * {\\n    position: relative;\\n  }\\n  \\n  .grvsc-gutter-pad {\\n    display: table-cell;\\n    padding-left: 0.75rem;\\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\\n  }\\n  \\n  .grvsc-gutter {\\n    display: table-cell;\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n  \\n  .grvsc-gutter::before {\\n    content: attr(data-content);\\n  }\\n  \\n  .grvsc-source {\\n    display: table-cell;\\n    padding-left: 1.5rem;\\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\\n    padding-right: 1.5rem;\\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\\n  }\\n  \\n  .grvsc-source:empty::after {\\n    content: ' ';\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n  \\n  .grvsc-gutter + .grvsc-source {\\n    padding-left: 0.75rem;\\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\\n  }\\n  \\n  /* Line transformer styles */\\n  \\n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\\n    content: ' ';\\n    position: absolute;\\n    width: 100%;\\n  }\\n  \\n  .grvsc-line-diff-add::before {\\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\\n  }\\n  \\n  .grvsc-line-diff-del::before {\\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\\n  }\\n  \\n  .grvsc-line-number {\\n    padding: 0 2px;\\n    text-align: right;\\n    opacity: 0.7;\\n  }\\n  \\n\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"Dynamic Connector Configuration","date":"2020-12-29T00:00:00.000Z","tags":["mft","connectors","sftp","mulesoft"],"shortDescription":"Frequently when building integrations, especially batch jobs, we don't necessarily know the configuration for all of the systems we will be connecting to ahead of time; the configurations are typically (and should be) externalized. While it doesn't feel intuitive, we can create a global configuration and use scoped variables to dynamically create new connector configurations at runtime."}}},"pageContext":{"slug":"/2020/dynamic-connector-config/"}},"staticQueryHashes":["1375839498","3128451518","324868815"]}