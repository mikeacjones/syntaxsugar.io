<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.b7ad9e4b7d1ac46737de.css" id="gatsby-global-css">.codeWrapper{position:relative;max-width:98%;margin-left:auto;margin-right:auto}.ConfettiWrapper{position:absolute;top:0;right:0;z-index:9}.CodeLanguageStub{left:8px;box-shadow:"none";-webkit-user-select:none;-ms-user-select:none;user-select:none}.CodeLanguageStub,.CopyCodeButton{position:absolute;top:0;margin:0;border:none;padding:8px 12px;background:#52307c;border-bottom-left-radius:8px;border-bottom-right-radius:8px;color:#ffffd2;font-size:14px;font-family:Ubuntu Mono,monospace;line-height:1;z-index:90}.CopyCodeButton{right:8px;box-shadow:none;text-decoration:none;cursor:pointer}.CodeWrapper-pre{text-align:left;margin:1em 0;padding:2rem;position:relative;overflow-x:auto;border-radius:3px;font-family:Ubuntu Mono,monospace}.CodeWrapper-pre .token-line{line-height:1.3em;white-space:pre-wrap}.CodeWrapper-span{display:inline-block;width:2em;-webkit-user-select:none;-ms-user-select:none;user-select:none;opacity:.3}code{font-family:Ubuntu Mono,monospace;font-size:1em!important}.grvsc-source{display:inline-block}span.grvsc-source>span{display:inline-block;word-break:break-all;word-wrap:break-word}.gatsby-resp-image-wrapper,.ZoomableImage{width:98%!important;max-width:700px!important;overflow:hidden;cursor:pointer;margin-left:auto;margin-right:auto;border:1px solid #3b415c;box-shadow:none!important}.ZoomableImage-enlarged{position:fixed;top:0;left:0;right:0;bottom:0;cursor:pointer;display:flex;padding:50px;z-index:100;background-color:rgba(0,0,0,.8)}.ZoomableImage-enlarged img{width:100%;height:auto;position:unset!important;box-shadow:none!important}#SocialIcons{height:60px;font-size:25px;width:100%;display:flex;justify-content:space-evenly}#SocialIcons i{cursor:pointer;transition:all .5s ease}#SocialIcons i:hover{color:#fff;transform:scale(1.3)}#MenuItems{list-style:none;font-size:1.2rem}#MenuItems a{text-decoration:none}#MenuItems a li{padding-right:1rem;margin-bottom:1rem;transition:border-width .5s ease}#MenuItems a li:after{content:"";display:block;width:0;height:1px;background:#ffffd2;transition:width .3s}#MenuItems a.active li:after,#MenuItems a:hover li:after{width:100%;padding-right:1rem}#AboutMe{margin-top:100px;flex:1 1 auto;display:flex;flex-direction:column;align-items:center}#AboutMe-ProfilePicture{width:70%;height:auto;margin-left:auto;margin-right:auto;transition:all .5s ease;border-radius:50%;overflow:hidden}#AboutMe-ProfilePicture:hover{transform:scale(1.1)}#AboutMe-ProfilePicture img{width:100%;-ms-user-select:none;user-select:none;-webkit-user-drag:none;-moz-user-select:none;-webkit-user-select:none}#AboutMe-MenuItems{width:100%;display:flex;flex-direction:column;align-items:flex-end}.SideBarWrapper{flex:0 0 18rem;z-index:98}#SideBar{background-color:#3b415c;color:#ffffd2;position:fixed;width:18rem;height:100%;display:flex;flex-direction:column}@media only screen and (max-width:1000px) and (-webkit-min-device-pixel-ratio:2){.SideBarWrapper{flex:0 0}#SideBar{transition:all .5s ease;transform:translateX(-18rem)}}@media only screen and (max-width:1000px) and (-webkit-min-device-pixel-ratio:2){#ContentWrapper{margin-top:60px}}#SideBarToggle{background-color:#3b415c;color:#ffffd2;font-size:2.5rem;border-bottom:1px solid #ffffd2}#SideBarToggle-checkbox{display:none}#SideBarToggleWrapper{display:none;width:100%;flex:0 0 50px;z-index:99;position:fixed;-ms-user-select:none;user-select:none;-webkit-user-select:none;-moz-user-select:none}.toggle{padding-left:10px;justify-self:center;cursor:pointer}#SideBarToggle{width:100%}@media only screen and (max-width:1000px) and (-webkit-min-device-pixel-ratio:2){#SideBarToggleWrapper{display:block}#SideBarToggle-checkbox:checked+#SideBar{transform:translateX(0)}}.svg-inline--fa,svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;transform:translate(-50%,-50%);transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;transform:scale(.25);transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;transform:scale(.25);transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;transform:scale(.25);transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;transform:scale(.25);transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;transform:scale(.25);transform-origin:top left}.fa-lg{font-size:1.33333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:.08em solid #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{animation:fa-spin 2s linear infinite}.fa-pulse{animation:fa-spin 1s steps(8) infinite}@keyframes fa-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.fa-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";transform:rotate(90deg)}.fa-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";transform:rotate(180deg)}.fa-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";transform:rotate(270deg)}.fa-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";transform:scaleX(-1)}.fa-flip-vertical{transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical,.fa-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{transform:scale(-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270{filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor)}.svg-inline--fa .fa-secondary,.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fad.fa-inverse{color:#fff}body,html{margin:0;padding:0;font-family:Titillium Web,sans-serif;background-color:#efefef}a{color:inherit;-webkit-user-drag:none}#Layout{display:flex;flex-direction:row;min-height:100vh;overflow:hidden}#Layout-ContentWrapper{flex:1 1 auto;display:flex;flex-direction:column}.autolink-header{padding-left:10px;display:none}h1,h2,h3,h4,h5,h6{pointer-events:none}.paging-links{width:100%;text-align:center;margin-top:30px}.paging-links a{text-decoration:none;font-size:1.2rem;background-color:#3b415c;color:#ffffd2;border-radius:8px;padding:8px;margin:4px}.paging-links a.disabled{background-color:#ccc;cursor:not-allowed}.grvsc-code{padding-top:25px}.grvsc-line{white-space:pre-wrap}code:not(.grvsc-code){display:inline-block;white-space:pre-wrap;padding:5px;margin:5px;border-radius:5px;background-color:#efefef}.div-paragraph{margin:30px 0}blockquote{border:1px solid #cdcdcd;border-left-width:10px;padding-left:5px}.iframe-wrapper{width:50%;margin-left:auto;margin-right:auto}@media only screen and (max-width:1000px) and (-webkit-min-device-pixel-ratio:2){.iframe-wrapper{width:100%}h1,h2,h3,h4,h5,h6{margin-top:-60px;padding-top:60px}}.Chip{font-size:12px;background-color:#eddbf4;padding:8px;border-radius:10px;color:#000;transition:all .5s ease;margin:4px;z-index:15;-ms-user-select:none;user-select:none;-moz-user-select:none;-webkit-user-drag:none;-webkit-user-select:none}.Chip-link{text-decoration:none;color:inherit}.Chip.active{background-color:#52307c;color:#eddbf4}.Chip:hover{transform:scale(1.15)}.PostCard{color:#52307c;background-color:#fff;padding:20px;margin:15px 20px 0;cursor:pointer;position:relative;box-shadow:0 1px 2px rgba(0,0,0,.1);border-radius:0;transition:all .6s cubic-bezier(.165,.84,.44,1);-ms-user-select:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-webkit-user-drag:none}.PostCard-description{color:#663a82}.PostCard:hover{transform:scale(1.005)}.PostCard:after{content:"";border-radius:0;position:absolute;z-index:-1;top:0;left:0;width:100%;height:100%;box-shadow:0 5px 15px rgba(0,0,0,.3);opacity:0;transition:all .6s cubic-bezier(.165,.84,.44,1)}.PostCard:hover:after{opacity:1}.PostCard-title{font-size:30px;font-weight:700}.PostCard-date{font-weight:lighter}.PostCard-tags{display:flex;flex-direction:row;margin-top:10px}.PostCard-link{z-index:10;position:absolute;top:0;left:0;right:0;bottom:0;-webkit-user-drag:none}.LabCard{width:28%;max-width:28%;margin-top:2%;white-space:pre-wrap;color:#52307c;background-color:#fff;padding:20px;cursor:pointer;box-shadow:0 1px 2px rgba(0,0,0,.1);border-radius:0;transition:all .6s cubic-bezier(.165,.84,.44,1);display:flex;flex-direction:column;justify-content:space-between;position:relative}.LabCard-link{position:absolute;top:0;left:0;right:0;bottom:0;-webkit-user-drag:none}.LabCard:hover{transform:scale(1.005)}.LabCard:after{content:"";border-radius:0;position:absolute;z-index:-1;top:0;left:0;width:100%;height:100%;box-shadow:0 5px 15px rgba(0,0,0,.3);opacity:0;transition:all .6s cubic-bezier(.165,.84,.44,1)}.LabCard:hover:after{opacity:1}.LabCard-header{display:flex;flex-direction:column;margin-bottom:20px}.LabCard-title{color:#663a82;font-size:30px}.LabCard-updated{font-size:12px;align-self:flex-start}.LabCard-body{overflow:hidden;margin-bottom:20px}.LabCard-footer{display:flex;flex-direction:row;width:100%}@media only screen and (max-width:1000px) and (-webkit-min-device-pixel-ratio:2){.LabCard{margin:15px 20px 0;width:100%;max-width:100%}}.LabCards{justify-content:space-evenly}.category-tags,.LabCards{display:flex;flex-direction:row;flex-wrap:wrap}.category-tags{margin-left:auto;margin-right:auto;width:90%;justify-content:center}.post-view{background-color:#fff;display:flex;flex-direction:column;align-items:center;min-height:100vh;font-size:1em}.post-view-content{align-self:stretch;padding:1rem 6rem 6rem}.post-view img{display:block;max-width:100%;max-height:100%;height:auto;margin-left:auto;margin-right:auto;-o-object-fit:contain;object-fit:contain}.embedVideo-container{display:block;max-width:98%;width:700px}.embedVideo-iframe{width:100%;height:400px}.post-view-title{color:#52307c;padding:0}.post-view-title,.post-view-title h1{margin:0;word-wrap:break-word;text-align:center}.post-view-title h1{font-size:4em}.post-view-date{padding:0;font-weight:lighter;font-size:1rem;text-align:center}@media only screen and (max-width:1000px) and (-webkit-min-device-pixel-ratio:2){.post-view-title h1{font-size:3em;padding:0;margin:0}.post-view-date{margin:0;font-size:1rem}.post-view-content{padding:2px}}</style><meta name="generator" content="Gatsby 2.29.2"/><title data-react-helmet="true">Streaming Data and Deferred Dataweave - Michael Jones</title><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link data-react-helmet="true" rel="icon" type="image/svg+xml" href="/favicon.svg"/><link data-react-helmet="true" rel="manifest" href="/site.webmanifest"/><link data-react-helmet="true" rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"/><meta data-react-helmet="true" name="description" content="Processing data in an Enterprise environment frequently involves very large files. In a traditional approach, processing these files can involve issues around memory and time as it involves first downloading the entire file, attempting to load the entire file into memory to work on, and then saving the whole file to output. Instead of taking this old-fashioned approach, we can utilized data streaming and deferred dataweave processing in order to streamline this process."/><meta data-react-helmet="true" name="keywords" content="mulesoft, dataweave, streaming, memory"/><meta data-react-helmet="true" itemProp="name" content="Streaming Data and Deferred Dataweave - Michael Jones"/><meta data-react-helmet="true" itemProp="description" content="Processing data in an Enterprise environment frequently involves very large files. In a traditional approach, processing these files can involve issues around memory and time as it involves first downloading the entire file, attempting to load the entire file into memory to work on, and then saving the whole file to output. Instead of taking this old-fashioned approach, we can utilized data streaming and deferred dataweave processing in order to streamline this process."/><meta data-react-helmet="true" itemProp="image" content="https://syntaxsugar.io/favicon.svg"/><meta data-react-helmet="true" property="og:url" content="https://syntaxsugar.io"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="Streaming Data and Deferred Dataweave - Michael Jones"/><meta data-react-helmet="true" property="og:description" content="Processing data in an Enterprise environment frequently involves very large files. In a traditional approach, processing these files can involve issues around memory and time as it involves first downloading the entire file, attempting to load the entire file into memory to work on, and then saving the whole file to output. Instead of taking this old-fashioned approach, we can utilized data streaming and deferred dataweave processing in order to streamline this process."/><meta data-react-helmet="true" property="og:image" content="https://syntaxsugar.io/favicon.svg"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Streaming Data and Deferred Dataweave - Michael Jones"/><meta data-react-helmet="true" name="twitter:description" content="Processing data in an Enterprise environment frequently involves very large files. In a traditional approach, processing these files can involve issues around memory and time as it involves first downloading the entire file, attempting to load the entire file into memory to work on, and then saving the whole file to output. Instead of taking this old-fashioned approach, we can utilized data streaming and deferred dataweave processing in order to streamline this process."/><meta data-react-helmet="true" name="twitter:image" content="https://syntaxsugar.io/favicon.svg"/><meta data-react-helmet="true" name="msapplication-TileColor" content="#da532c"/><meta data-react-helmet="true" name="theme-color" content="#ffffff"/><link href="https://fonts.googleapis.com/css?family=Titillium+Web|Ubuntu+Mono&amp;display=swap" rel="stylesheet"/><link as="script" rel="preload" href="/webpack-runtime-39e853c4c9ac12c9a5f9.js"/><link as="script" rel="preload" href="/framework-cd3e1e804d552fa282ef.js"/><link as="script" rel="preload" href="/app-c0f7b2835c835335c896.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/a9a7754c-34b8923232843e7049e0.js"/><link as="script" rel="preload" href="/commons-19960ce6d504fea6edc6.js"/><link as="script" rel="preload" href="/417f07d9c8fb71f0b05fb9fb3720dd621d3ab4d5-1102b991d7103fbe13c4.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-05712a94761f2f76bc18.js"/><link as="fetch" rel="preload" href="/page-data/post/2021/streaming-and-deferred-dw/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1375839498.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3128451518.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/324868815.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="Layout"><div class="SideBarWrapper"><input type="checkbox" id="SideBarToggle-checkbox" name="" value=""/><div id="SideBar"><div id="AboutMe"><a class="link-to" id="AboutMe-ProfilePicture" href="/"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:100%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGB0lEQVQ4yx3U+1fT9x3H8c93vUyNVbtqsdgpFHVQrHcLdFJBNqqAFoJACIFlJCC0cgcpBARCuUhGEIJoIIBcFBAMIhaRiyi3gBjFBqFom+1wPHMXf9h22q32++X9Gvb9BzzO8/XLm1nnH7CZByPssWWSuz89xrW1VjLwEF3tMMibDFpjVbl6ob5aI7RfLhe0NUELDU15RsvdcfnVtlLR+K0udnf8Bjfcc4kbvXmZjfd3MHap9izraqvnADDzvRFmbNdLs4tDrYk53lCXhuNMxUm0NpzDuep05Gl98WWZFH29Tbg/MWAdG+yU3hv9iukzE9iD0eucZeIGY72dF7n57n728oaHjLrODgMiknfAPYzxyaddeI0hkPQNKXSm7AtKy/EhWbwD39Jxmp/92oSRwU70ddbrahsKmbkhiZmHrnBsqeznurGhHt3U3UG0t+r58/UqISxuF30SsJ2Ux/0oKyeI0r+QUVFFLB2NsKO29rP0l28fCmO3r/GD15sxNdyle/ToETNNmTl2PFTCkqMU0vbmOkw/HONbW85S6ZkM7PxgO732ykpa9tobeOctG9hvWAdXd2f4SPfRkdB9pDuXh6mxXhq43sTP3B8C/+P30p/+92/2slBkbG2xXrxQ8xIUagxlOOrnS++ts0GIuxvEbh9iv+NWuDjYw8HGFi6ezvA65gxPv22kyj2O/u5m4RvLOGhRsP70w4+il6B8eOAW6vWVvGVmgjIzUikqIhYDFVrM6dSY1eVjrDAN11WfISPwMGzX/Qq7vVZh636GbR4iammuoCezkzzRIgSelzNtY6wx78tYNNdW8/enRyglJZm6O+/gb7cGMVd+agnNg7kkHaOFCbiWHQPX32zFjo/WI/yEOyqrTtHQjXb685PpJZCwKPBGFpK1fEGVFY5rl1voocVEJZpiTN2x4MEFA+YrizCvK8BoQTpaUpS4khWLZKk/tuy2Qb4mEfdM/UjNCqXhkW5aWooXPL/ARiwdwvBtE/IKMqijs44utlzAzZYOaCIl6FIlYLaiAOVKKTKP+SFf5g9tvALB3nsQleKPprYSHAxbRdHpHvT3Z0/w7OmcwCbn/ymka4vheOBVOhj4LjU1VePh1U7oYyLQGBOGifw0FIkP4bTkU5xXiHEhUYEMhQ/iCkNQWa1CeU085WhCyGwy4rG5T2DZesOC8qQ/gpVO5BGwk06p0/Ft/zgmM5JgrfwTHhuqUR8uxnh6Au6cjENjcjTqqvKRVSZBuU6FriuXyGQepn+94PFicXGBBUTvMhaUpCBXo+ZDYsJIEimh74zdmM7LxM3sdAwW5CPFcz+unIiGpfAUyqNCoS3KRJWhGCWlcVRRFUNPvpvn//PDf/GP58+NTBK/XZ5WqUNyaRGfmB9FshgZdRSqURYphavdRkS5uuGjX2+C68YNUEuOIMLDDUlJEkRn/RaqPA+qqkmjvz5b4Ifu3EZ5WamcldTNiGTxn1u9A3fBN9RFUKZJIfM/Sp47d6L0j1LURyuQ5HUA7lvew7ur18DVaSsaGkuQWvQxVWltMNDTKDx99hSjkxPWQm2xiPkc+5jt27VK6umzB/KkGD4xO5+8PwnAZntHknl5UoDLXrjY2cH2zbVY/voK7HF2pNpzetKcTUKr3o1mTXr+67lvMDZhkppn5hgra7zFyYLDWbyqWHcyuxTSPyTyTjs8Badt+8hhkwP57N1L2zfZ0fJlb9CqlWvo7bUb6PAhH/osLkHIy07lG84XoKe3V3ex/RpraKzlWGhIMKcIk7Oe78Fioo7rPhWH4fWVdtjx/m7ebqMDv2b1WlqxYjWtf+tt2u/sTCtE7/BeB735kKAgiMXBUESf0JmfPmf97edZmbZsCZQGM5kslMNIH9ts78SO+AZIX1lma7Vda4/I3x2A0vf3SA46Al20BK6OH4D75Xr4+R5FhCzcGiQOlErkyT//0qKCfK6urp4xpfJzplTEsKSEVG6Lsxt36HAAs9+wWcRetZGHuX1obIyXLfTlnBAy/A8L7BfrFla/aW+UhobJYxWRomPiQKbKVXPq3FwuNSWVaTQa9n+KHZEX8OTqGwAAAABJRU5ErkJggg==" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/3f7c935dcce0978397a510e419a6a0c1/69585/profilePicture.png 200w,
/static/3f7c935dcce0978397a510e419a6a0c1/497c6/profilePicture.png 400w,
/static/3f7c935dcce0978397a510e419a6a0c1/ee604/profilePicture.png 800w,
/static/3f7c935dcce0978397a510e419a6a0c1/05d05/profilePicture.png 1080w" sizes="(max-width: 800px) 100vw, 800px" /><img loading="lazy" sizes="(max-width: 800px) 100vw, 800px" srcset="/static/3f7c935dcce0978397a510e419a6a0c1/69585/profilePicture.png 200w,
/static/3f7c935dcce0978397a510e419a6a0c1/497c6/profilePicture.png 400w,
/static/3f7c935dcce0978397a510e419a6a0c1/ee604/profilePicture.png 800w,
/static/3f7c935dcce0978397a510e419a6a0c1/05d05/profilePicture.png 1080w" src="/static/3f7c935dcce0978397a510e419a6a0c1/ee604/profilePicture.png" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></a><h1>Michael Jones</h1><div id="AboutMe-MenuItems"><div><ul id="MenuItems"><a class="" href="/"><li>Posts</li></a><a href="/dw-cookbook"><li>DW Cookbook</li></a><a href="/labs/"><li>Labs</li></a></ul></div></div></div><div id="SocialIcons"><i><a href="https://github.com/mikeacjones" class="link-to" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" alt="github"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></i><i><a href="https://www.linkedin.com/in/michael-jones-5a870678/" class="link-to" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin fa-w-14 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" alt="linkedin"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></i><i><a href="https://stackoverflow.com/users/10890536/michael-jones" class="link-to" target="_blank" rel="noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="stack-overflow" class="svg-inline--fa fa-stack-overflow fa-w-12 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" alt="stackoverflow"><path fill="currentColor" d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"></path></svg></a></i></div></div></div><div id="Layout-ContentWrapper"><div id="SideBarToggleWrapper"><div id="SideBarToggle"><label for="SideBarToggle-checkbox" class="toggle">â˜°</label></div></div><div id="ContentWrapper"><div class="post-view"><div class="post-view-header"><div class="post-view-title"><h1>Streaming Data and Deferred Dataweave</h1><div class="post-view-date">Written on <!-- -->2021-01-05</div><a href="https://github.com/mikeacjones/syntaxsugar.io/issues/new?labels=post%20question&amp;assignees=mikeacjones&amp;title=Streaming Data and Deferred Dataweave&amp;body=I%20have%20a%20question/issue%20about:" referrer="noreferrer" target="_blank"><h3><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" alt="github"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> Ask Question / Submit Issue</h3></a></div></div><div class="post-view-content"><div class="div-paragraph">Before we start talking about streaming and deferred dataweave, lets consider a traditional batch approach. In this example, we will be considering a process which downloads a large CSV (GB size range), transforms the data to JSON, and then upserts this information into Salesforce. The step by step process for that probably looks like this:</div><ol><li>Download file from SFTP to local file system</li><li>After downloading file, open file and start reading line by line and building an in-memory JSON object structure</li><li>Write in-memory object structure to JSON file</li><li>Using batch API, upload  JSON file to Salesforce for upsert</li></ol><div class="div-paragraph">There are a lot of inefficiencies with this approach! The first and biggest is that we are waiting until we&#x27;ve finished downloading the file to even start working on it. Given the potential size of these files, that can translate to a lot of wasted time! The next issue is that typically we try and transform the entire file in a single go, which can cause quite a few issues around memory - writing this data to file after transforming it in-memory is also inefficient because I/O operations tend to be slow, and depending on the size of the file and the environment that we are working in (such as CloudHub) we might potentially be running into issues around disk space.</div><div class="div-paragraph">Let&#x27;s talk about a better way..</div><h2 id="what-is-streaming" style="position:relative">What is Streaming?<a href="#what-is-streaming" aria-label="what is streaming permalink" class="autolink-header after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2><div class="div-paragraph">Streaming, at least in this context, is the idea that when we download a file, receive data from an HTTP endpoint, etc, the data comes in as a stream of data; we don&#x27;t just receive everything in a single huge chunk! In a traditional approach, we wait until we&#x27;ve received all of the data before we start working on it; with a streaming approach, we work on the data as we receive the bytes, which are stored in a working buffer. Mulesoft makes working with streams easy and, typically, seamless.</div><h2 id="what-is-deferred-dataweave" style="position:relative">What is Deferred Dataweave?<a href="#what-is-deferred-dataweave" aria-label="what is deferred dataweave permalink" class="autolink-header after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2><div class="div-paragraph">From the documentation:</div><blockquote><div class="div-paragraph">DataWeave processes streamed data as its bytes arrive instead of scanning the entire document to index it. When in deferred mode, DataWeave can also pass streamed output data directly to a message processor without saving it to the disk. This behavior enables DataWeave and Mule to process data faster and consume fewer resources than the default processes for reading and writing data.</div></blockquote><div class="div-paragraph">It is pretty straightforward to understand what this means: we can stream everything from input to output! This allows us to transform the data from our SFTP file <strong>as it arrives</strong> rather than waiting for the entire file; whether this data is CSV, JSON, or XML, DataWeave will handle aggregating the chunks of data received into appropriate data structures which we can work on.</div><h1 id="lets-build-an-example-project" style="position:relative">Let&#x27;s Build an Example Project<a href="#lets-build-an-example-project" aria-label="lets build an example project permalink" class="autolink-header after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h1><div class="div-paragraph">Personally, I&#x27;ve always found building a working example to be the best way to illustrate a point. To keep things simple, we&#x27;re going to build a basic application which will download a very large CSV file provided by the CDC on COVID-19 cases, transform the data structure to JSON, and stream the response back to our HTTP Listener. This means that, without ever writing the file to disk, we will be able to watch in our browser/postman/curl command as the CSV file is downloaded and transformed!</div><h2 id="overview" style="position:relative">Overview<a href="#overview" aria-label="overview permalink" class="autolink-header after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2><div class="div-paragraph">We will be downloading a 1.59GB CSV file with a structure like this:</div><div class="codeWrapper"><button class="CopyCodeButton">Copy</button><div class="CodeLanguageStub">csv</div><div class="ConfettiWrapper"><div style="position:relative"></div></div><pre class="grvsc-container community-material-theme-palenight" data-language="csv" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">cdc_case_earliest_dt ,cdc_report_dt,pos_spec_dt,onset_dt,current_status,sex,age_group,race_ethnicity_combined,hosp_yn,icu_yn,death_yn,medcond_yn</span></span>
<span class="grvsc-line"><span class="grvsc-source">2020/03/23,2020/03/31,2020/03/23,,Laboratory-confirmed case,Female,0 - 9 Years,&quot;Black, Non-Hispanic&quot;,Unknown,Unknown,Unknown,Unknown</span></span></code></pre></div><div class="div-paragraph">And converting it to a JSON structure like this:</div><div class="codeWrapper"><button class="CopyCodeButton">Copy</button><div class="CodeLanguageStub">json</div><div class="ConfettiWrapper"><div style="position:relative"></div></div><pre class="grvsc-container community-material-theme-palenight" data-language="json" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk5">[</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk5">{</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk12">earliestDt</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">2020/03/23</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk12">reportDt</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">2020/03/31</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk12">spectDt</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">2020/03/23</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk12">onsetDt</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk4">null</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk12">status</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">Confirmed</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk12">patient</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">{</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk7">sex</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">Female</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk7">ageGroup</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">0 - 9 Years</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk7">raceEthnicity</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">Black, Non-Hispanic</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk7">hospYn</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">Unknown</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk7">icuYn</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">Unknown</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk7">deathYn</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">Unknown</span><span class="mtk5">&quot;,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk7">medCondYn</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">&quot;</span><span class="mtk6">Unknown</span><span class="mtk5">&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk5">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5">]</span></span></span></code></pre></div><h3 id="building-the-application" style="position:relative">Building the Application<a href="#building-the-application" aria-label="building the application permalink" class="autolink-header after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3><ol><li>Open up Anypoint Studio and create a new application called <code>large-csv-to-json</code></li><li>Add an HTTP Listener to the palette and create a default configuration. Set the endpoint to <code>/large-csv-test</code></li><li>I have the file hosted for you in Dropbox, so we&#x27;re going to use a REST Request in order to download this file:<ol><li>Drag a REST Request onto the palette </li><li>Now, in order to tell the Request that we want to treat the response as a stream, create a new Request configuration and check the box that says &quot;Stream response&quot;
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:700px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:139.42857142857144%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAABYlAAAWJQFJUiTwAAADr0lEQVRIx51WTW/jVBT1v2XJLFmzREKzAVb8AZBGYgESzKKtqhbIMEwax/ly/J3vxE7cfDRu0/Zwz21exnSmTIWl0+dn+9137znn3dTq/1FB1Pbxqv0z3nhvEfkRul4XQRAofN9XtNttRaPRwMnJCY6OjnB6eorj42OcnZ3h/Pxc7616vY5ms4nAD+B2XERxhF6vB8dx0Ol00O12FdvtFnd3d7i9vcXNzY3Oi6I44Pr6WkfL8zxdwMWVSkXHVquFi4sLVKtVvWdW8/kcy+VSRwZ76rKyLMNwMMBAMJlMdMFoNMJsNgPf5Xmuz6bTKfr9PqIo0me87u/vP4CF/3l9LJgGdHsjdOIhkkmGIIyEeBdx3EOc9OB2PXjCbdLri1A+wjAWfgf6fDpNMUszqSR7GPew4jgGwfL8IIRdd3QBF9u2A6chggWRcCnctju6Uc2uCy0TDcbA09l7WFQmTVPFeDzGcDjEarV6VslU/TEsKmcCkXgKwnG9XuPy8lKV5QYEn5XnV1dXYpWtqm5g8Q+zo0UYjIFpGeNBepRzjrQYv7NtW31Kmui/fwWkSR92KvQBdzYvjZFNObw34Hy326nJy7AYgFkN9l4Mw1CPGj351CIDvnsMi9nRxDy3RnEaNxYDL/KFcmayfw6UQ54EkyF5JKfcwIjCb7jxc2CR1M1mo4s4cs5SeX2Mu0/BohVoG55Rgtl9irv/gmVqZ1DXdQ9WoVDGdwacl0FBSUsZKgpvGIDeY1AKQ3NTrDLIrwH55jfc6IOA5rTQrLVaTQWhactBSQWDsPnSVtycczqAMQ4qlwPyRHCB6X+PM2R3ZxAjnhGyjENABujK0er3B7qYcwPOaXR2bzbZxWKhXn3M377kjQYkL479DpPRQBY8dGku5GhAOlgBBXnK7JphLpHz+Qx/e2vY3TH6SSgWirUZ0EpJkiivdADvme1YRCSYCOky2Ku8RJZOUHVTNL0hosCD+fFiQKoeSsAoDKSCkSawkGzymx1WbHNSfr6HRSJZMm3z7m0FrWZDWxRBEcgfuUll09l6g0JOUCFBdi0HxU8/YvzN11gKzxvZgFQcRBlJuk2nhobz0OtobmMjW35Gs8rvSF79gNH332H41ZfoffsSw99+wTyJccXf6DKHLHkuJf/pjPGX7aPVqKvP2qJqk/8xSEMdvPgM7hefw339KyK3g8lyhfm2wJx0iWfpU44lUaaoBis0g6m0Ll/twd5I/khHLCeIHlwU19LWcmQ0u5Sa7k1v8A96rjLbXT8GMwAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <div role="button" class="ZoomableImage"><img alt="stream-response-settings.png" class="gatsby-resp-image-image" title="stream-response-settings.png" src="/static/e5f21d43f667cdbb97ac2fe84fda1473/8c557/stream-response-settings.png" srcSet="/static/e5f21d43f667cdbb97ac2fe84fda1473/4edbd/stream-response-settings.png 175w,/static/e5f21d43f667cdbb97ac2fe84fda1473/13ae7/stream-response-settings.png 350w,/static/e5f21d43f667cdbb97ac2fe84fda1473/8c557/stream-response-settings.png 700w,/static/e5f21d43f667cdbb97ac2fe84fda1473/5ebd7/stream-response-settings.png 704w" sizes="(max-width: 700px) 100vw, 700px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/></div>
    </span></li><li>Paste the URL to the file into the REST request component, and make sure the request is set as a GET operation.<ul><li>URL: <code>https://www.dropbox.com/s/w2knq9ds4wlmp4o/COVID-19_Case_Surveillance_Public_Use_Data.csv?dl=1</code></li></ul></li></ol></li><li>After the Request operation, add a Transform component and paste the following dataweave. By adding <code>deferred=true</code>, we tell the script to evaluate in a lazy way, meaning it won&#x27;t process the transformation until the output is actually being consumed.</li></ol><div class="codeWrapper"><button class="CopyCodeButton">Copy</button><div class="CodeLanguageStub">data-weave</div><div class="ConfettiWrapper"><div style="position:relative"></div></div><pre class="grvsc-container community-material-theme-palenight" data-language="data-weave" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">%dw</span><span class="mtk1"> </span><span class="mtk3 mtki">2.0</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk12">output</span><span class="mtk1"> </span><span class="mtk6">application/json</span><span class="mtk1"> deferred=true</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk12">---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">payload</span><span class="mtk9"> map </span><span class="mtk5">{</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk6">earliestDt</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.cdc_case_earliest_dt</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk6">reportDt</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.cdc_report_dt</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk6">spectDt</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.pos_spec_dt</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk6">onsetDt</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.onset_dt</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk6">status</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.current_status</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">&quot;</span><span class="mtk6">patient</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk5">{</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk6">sex</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.sex</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk6">ageGroup</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.age_group</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk6">raceEthnicity</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.race_ethnicity_combined</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk6">hospYn</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.hosp_yn</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk6">icuYn</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.icu_yn</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk6">deathYn</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.death_yn</span><span class="mtk5">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk5">&quot;</span><span class="mtk6">medCondYn</span><span class="mtk5">&quot;:</span><span class="mtk1"> </span><span class="mtk10">$</span><span class="mtk1">.medcond_yn</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk5">}</span></span></span></code></pre></div><div class="div-paragraph">That&#x27;s it; we now have a flow that will initiate downloading the CSV file, and as the file is downloaded, it will transform the output to JSON and stream the response back to the application that made the request. Your flow should now look like this:</div><div class="div-paragraph"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:413px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:65.14285714285714%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/UlEQVQ4y6WR24vTQBTG8/8KK6w3vOCDD8KCyD4o4gUEES3t01J8CPrQJ6mSrm23dbfdNrYNtN3U3NqmTeaSz5nJppsuiqBDPk7mzJzffGdGa/QmqLZMtAcWepMJmn0Ln5s9fB/NMFlwnIUMAePwKcd0wTCeM5FP42zNMeccHuEqJ6UBHFJGjeL5KwJrxMQ8EZ+QGOsQePuOQf/IcXnYZwmevaT48vViTZPFS1G0e5vi+l2KvX2KOA7huIGIPt68X2H3DsWVawSNo1jk5vD8BZZLD4+fRLh6k2BHyHGTC6BwjRevCe49iHDwgSnHcUxFZKh9Y7h1n+LhI4qfTtoNpVyt6Z8odm4Q7D+lIgfVmcZ5SmYsgT1bb6xznrXBMRxFcByiCpLz20iSFGoOCBZLIvZLCWAQBOj3+6jVDHS7J6jX6/B9X6E8z8VgMMTxcROnpydCPURRpNZkTbVaxQ+zg8NDA+12G4QQ2TKEXQrLsjCdTuG6njg9UQ4zl74fYL1OQcn5Y8lDh8MhGs0jdDpdUeemwGxDfmRAGfPr2X8+t1qttuYboG3bMAwDYRheusNtwO/geamWpdVSqYRCoQBd15FdA2Ns0/qfJPfl4Vr6wgzlchnFYhGVSmUD/Bss05ZDCUtf1EOr1VJu/2do4/EYpmliNLJUlHMJjeP4n/QLH9rbFvGcUloAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <div role="button" class="ZoomableImage"><img alt="large-csv-to-jsonFlow.png" class="gatsby-resp-image-image" title="large-csv-to-jsonFlow.png" src="/static/ad7793f5b272418f95684d6359dd539f/6c1e7/large-csv-to-jsonFlow.png" srcSet="/static/ad7793f5b272418f95684d6359dd539f/4edbd/large-csv-to-jsonFlow.png 175w,/static/ad7793f5b272418f95684d6359dd539f/13ae7/large-csv-to-jsonFlow.png 350w,/static/ad7793f5b272418f95684d6359dd539f/6c1e7/large-csv-to-jsonFlow.png 413w" sizes="(max-width: 413px) 100vw, 413px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/></div>
    </span></div><div class="div-paragraph">Go ahead and run the application, and either browse to <code>http://localhost:8081/large-csv-test</code> or run the following CURL command:</div><div class="codeWrapper"><button class="CopyCodeButton">Copy</button><div class="CodeLanguageStub">bash</div><div class="ConfettiWrapper"><div style="position:relative"></div></div><pre class="grvsc-container community-material-theme-palenight" data-language="bash" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">curl http://localhost:8081/large-csv-test</span></span></span></code></pre></div><div class="div-paragraph">You should see something like this:</div><div class="div-paragraph"><div role="button" class="ZoomableImage"><img alt="curl.gif" src="/fa1873516f93f323a7d219f3cef62c61/curl.gif"/></div></div><div class="div-paragraph">As you can see, even though the 1.59GB file is still downloading, we are already seeing results from the transform.</div><h1 id="wrap-up" style="position:relative">Wrap Up<a href="#wrap-up" aria-label="wrap up permalink" class="autolink-header after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h1><div class="div-paragraph">Using a streaming strategy, both for your actual data and the processing of that data, is a very powerful tool that provides substantial time and memory gains. By downloading, transforming, and returning our results concurrently, we create a very fast process for handling very large files with millions of records. If you have any questions or ran into any issues implementing this, please use the link at the top of the page to reach out!</div><div class="div-paragraph">To download a complete working example of this project: <a href="https://github.com/mikeacjones/large-csv-to-json-stream-example" target="_blank" rel="noreferrer">https://github.com/mikeacjones/large-csv-to-json-stream-example</a></div><style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line &gt; * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: &#x27; &#x27;;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting &gt; .grvsc-code &gt; .grvsc-line::before {
    content: &#x27; &#x27;;
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .community-material-theme-palenight {
    background-color: #292D3E;
    color: #A6ACCD;
  }
  .community-material-theme-palenight .mtki { font-style: italic; }
  .community-material-theme-palenight .mtk5 { color: #89DDFF; }
  .community-material-theme-palenight .mtk1 { color: #FFFFFF; }
  .community-material-theme-palenight .mtk12 { color: #C792EA; }
  .community-material-theme-palenight .mtk6 { color: #C3E88D; }
  .community-material-theme-palenight .mtk4 { color: #F78C6C; }
  .community-material-theme-palenight .mtk7 { color: #FFCB6B; }
  .community-material-theme-palenight .mtk3 { color: #676E95; }
  .community-material-theme-palenight .mtk8 { color: #A6ACCD; }
  .community-material-theme-palenight .mtk9 { color: #82AAFF; }
  .community-material-theme-palenight .mtk10 { color: #FF5370; }
  .community-material-theme-palenight .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/post/2021/streaming-and-deferred-dw/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-f5ec1ff06108d0c85bab.js"],"app":["/app-c0f7b2835c835335c896.js"],"component---src-pages-404-js":["/component---src-pages-404-js-0d65b0984ce0dd3bfa05.js"],"component---src-templates-index-js":["/component---src-templates-index-js-9cc22a22addd47368c69.js"],"component---src-templates-labs-by-category-js":["/component---src-templates-labs-by-category-js-973fcc1462039ce127cc.js"],"component---src-templates-labs-js":["/component---src-templates-labs-js-4e36ac36c454f92e53fa.js"],"component---src-templates-post-js":["/component---src-templates-post-js-05712a94761f2f76bc18.js"],"component---src-templates-posts-by-tags-js":["/component---src-templates-posts-by-tags-js-b25cfef693d82f7d8f5c.js"]};/*]]>*/</script><script src="/polyfill-f5ec1ff06108d0c85bab.js" nomodule=""></script><script src="/component---src-templates-post-js-05712a94761f2f76bc18.js" async=""></script><script src="/417f07d9c8fb71f0b05fb9fb3720dd621d3ab4d5-1102b991d7103fbe13c4.js" async=""></script><script src="/commons-19960ce6d504fea6edc6.js" async=""></script><script src="/a9a7754c-34b8923232843e7049e0.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-c0f7b2835c835335c896.js" async=""></script><script src="/framework-cd3e1e804d552fa282ef.js" async=""></script><script src="/webpack-runtime-39e853c4c9ac12c9a5f9.js" async=""></script></body></html>